<Window x:Class="TimeTrackerApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:TimeTrackerApp.ViewModels"
        xmlns:material="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="Tempo - Time Tracker Pro"
        Height="800"
        Width="1400"
        MinWidth="1200" MinHeight="700"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        FontFamily="Inter, Segoe UI Variable Display, Segoe UI">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesign3.Defaults.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <!-- Modern Color Palette -->
            <Color x:Key="PrimaryColor">#6366F1</Color>
            <Color x:Key="SecondaryColor">#8B5CF6</Color>
            <Color x:Key="AccentColor">#06B6D4</Color>
            <Color x:Key="SurfaceColor">#1E1B23</Color>
            <Color x:Key="SurfaceVariantColor">#2A2831</Color>
            <Color x:Key="BackgroundColor">#0F0D15</Color>
            <Color x:Key="OnSurfaceColor">#E4E4E7</Color>
            <Color x:Key="OnSurfaceVariantColor">#A1A1AA</Color>
            <Color x:Key="SuccessColor">#10B981</Color>
            <Color x:Key="WarningColor">#F59E0B</Color>
            <Color x:Key="ErrorColor">#EF4444</Color>

            <!-- Brushes -->
            <SolidColorBrush x:Key="PrimaryBrush" Color="{StaticResource PrimaryColor}"/>
            <SolidColorBrush x:Key="SecondaryBrush" Color="{StaticResource SecondaryColor}"/>
            <SolidColorBrush x:Key="AccentBrush" Color="{StaticResource AccentColor}"/>
            <SolidColorBrush x:Key="SurfaceBrush" Color="{StaticResource SurfaceColor}"/>
            <SolidColorBrush x:Key="SurfaceVariantBrush" Color="{StaticResource SurfaceVariantColor}"/>
            <SolidColorBrush x:Key="BackgroundBrush" Color="{StaticResource BackgroundColor}"/>
            <SolidColorBrush x:Key="OnSurfaceBrush" Color="{StaticResource OnSurfaceColor}"/>
            <SolidColorBrush x:Key="OnSurfaceVariantBrush" Color="{StaticResource OnSurfaceVariantColor}"/>
            <SolidColorBrush x:Key="SuccessBrush" Color="{StaticResource SuccessColor}"/>
            <SolidColorBrush x:Key="WarningBrush" Color="{StaticResource WarningColor}"/>
            <SolidColorBrush x:Key="ErrorBrush" Color="{StaticResource ErrorColor}"/>

            <!-- Gradient Brushes -->
            <LinearGradientBrush x:Key="PrimaryGradientBrush" StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#6366F1" Offset="0"/>
                <GradientStop Color="#8B5CF6" Offset="1"/>
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="AccentGradientBrush" StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#06B6D4" Offset="0"/>
                <GradientStop Color="#0891B2" Offset="1"/>
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="BackgroundGradientBrush" StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#0F0D15" Offset="0"/>
                <GradientStop Color="#1A1625" Offset="1"/>
            </LinearGradientBrush>

            <!-- Modern Card Style with Glassmorphism -->
            <Style x:Key="GlassCard" TargetType="Border">
                <Setter Property="Background">
                    <Setter.Value>
                        <SolidColorBrush Color="#1E1B23" Opacity="0.8"/>
                    </Setter.Value>
                </Setter>
                <Setter Property="BorderBrush">
                    <Setter.Value>
                        <SolidColorBrush Color="#3C3C3C" Opacity="0.3"/>
                    </Setter.Value>
                </Setter>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="CornerRadius" Value="16"/>
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect ShadowDepth="0" BlurRadius="20" Opacity="0.3" Color="#000000"/>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Trigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetProperty="(UIElement.Effect).(DropShadowEffect.BlurRadius)" 
                                                   To="30" Duration="0:0:0.2"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </Trigger.EnterActions>
                        <Trigger.ExitActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetProperty="(UIElement.Effect).(DropShadowEffect.BlurRadius)" 
                                                   To="20" Duration="0:0:0.2"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </Trigger.ExitActions>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!-- Modern Button Style -->
            <Style x:Key="ModernButton" TargetType="Button" BasedOn="{StaticResource MaterialDesignFlatButton}">
                <Setter Property="Background" Value="{StaticResource PrimaryGradientBrush}"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="Height" Value="48"/>
                <Setter Property="Padding" Value="24,0"/>
                <Setter Property="material:ButtonAssist.CornerRadius" Value="12"/>
                <Setter Property="FontWeight" Value="Medium"/>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{StaticResource AccentGradientBrush}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!-- Modern TextBox Style -->
            <Style x:Key="ModernTextBox" TargetType="TextBox" BasedOn="{StaticResource MaterialDesignTextBox}">
                <Setter Property="Background" Value="{StaticResource SurfaceVariantBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource OnSurfaceBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="BorderBrush" Value="{StaticResource OnSurfaceVariantBrush}"/>
                <Setter Property="Padding" Value="16,12"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="material:TextFieldAssist.UnderlineBrush" Value="{StaticResource PrimaryBrush}"/>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Window.DataContext>
        <vm:MainViewModel />
    </Window.DataContext>

    <!-- Window Chrome -->
    <Border Background="{StaticResource BackgroundGradientBrush}" CornerRadius="12">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Custom Title Bar -->
            <Border Grid.Row="0" Height="60" Background="Transparent" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid Margin="24,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- App Branding -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Border Width="32" Height="32" CornerRadius="8" Background="{StaticResource PrimaryGradientBrush}">
                            <material:PackIcon Kind="TimerSand" Width="20" Height="20" Foreground="White" 
                                             HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <TextBlock Text="Tempo" Margin="12,0,0,0" FontSize="20" FontWeight="SemiBold" 
                                 Foreground="{StaticResource OnSurfaceBrush}" VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Navigation Tabs -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <RadioButton x:Name="ActiveTasksTab" Style="{StaticResource MaterialDesignTabRadioButton}"
                                   IsChecked="{Binding ShowActiveTasks}" Content="Active Tasks" Margin="20,0"
                                   Foreground="{StaticResource OnSurfaceBrush}" FontWeight="Medium"/>
                        <RadioButton x:Name="CompletedTasksTab" Style="{StaticResource MaterialDesignTabRadioButton}"
                                   IsChecked="{Binding ShowCompletedTasks}" Content="Analytics" Margin="20,0"
                                   Foreground="{StaticResource OnSurfaceBrush}" FontWeight="Medium"/>
                    </StackPanel>

                    <!-- Window Controls -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                        <Button Style="{StaticResource MaterialDesignIconForegroundButton}" Width="32" Height="32" 
                              Click="MinimizeButton_Click" Foreground="{StaticResource OnSurfaceVariantBrush}">
                            <material:PackIcon Kind="WindowMinimize" Width="16" Height="16"/>
                        </Button>
                        <Button Style="{StaticResource MaterialDesignIconForegroundButton}" Width="32" Height="32" 
                              Click="CloseButton_Click" Foreground="{StaticResource ErrorBrush}" Margin="8,0,0,0">
                            <material:PackIcon Kind="Close" Width="16" Height="16"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Main Content -->
            <Grid Grid.Row="1" Margin="24,0,24,24">
                <material:TransitioningContent OpeningEffect="{material:TransitionEffect FadeIn}">
                    <material:TransitioningContent.Style>
                        <Style TargetType="material:TransitioningContent">
                            <Style.Triggers>
                                <!-- Active Tasks View -->
                                <DataTrigger Binding="{Binding ShowActiveTasks}" Value="True">
                                    <Setter Property="Content">
                                        <Setter.Value>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="380"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <!-- Projects Sidebar -->
                                                <Border Grid.Column="0" Style="{StaticResource GlassCard}" Margin="0,0,12,0">
                                                    <Grid Margin="24">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>

                                                        <!-- Projects Header -->
                                                        <Grid Margin="0,0,0,24">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Projects" FontSize="24" FontWeight="Bold" 
                                                                     Foreground="{StaticResource OnSurfaceBrush}"/>
                                                            <Border Grid.Column="1" Background="{StaticResource PrimaryBrush}" CornerRadius="12" Padding="12,6">
                                                                <TextBlock Text="{Binding Projects.Count}" Foreground="White" FontWeight="Medium"/>
                                                            </Border>
                                                        </Grid>

                                                        <!-- Projects List -->
                                                        <ScrollViewer Grid.Row="1" Style="{StaticResource MaterialDesignScrollViewer}">
                                                            <ListBox ItemsSource="{Binding Projects}" 
                                                                     SelectedItem="{Binding SelectedProject}"
                                                                     Background="Transparent"
                                                                     BorderThickness="0"
                                                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                                <ListBox.ItemContainerStyle>
                                                                    <Style TargetType="ListBoxItem">
                                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                                                        <Setter Property="Padding" Value="0"/>
                                                                        <Setter Property="Margin" Value="0,0,0,12"/>
                                                                        <Setter Property="Template">
                                                                            <Setter.Value>
                                                                                <ControlTemplate TargetType="ListBoxItem">
                                                                                    <Border x:Name="border" Background="{StaticResource SurfaceVariantBrush}" 
                                                                                          CornerRadius="12" Cursor="Hand">
                                                                                        <ContentPresenter Margin="20,16"/>
                                                                                    </Border>
                                                                                    <ControlTemplate.Triggers>
                                                                                        <Trigger Property="IsSelected" Value="True">
                                                                                            <Setter TargetName="border" Property="Background" Value="{StaticResource PrimaryBrush}"/>
                                                                                        </Trigger>
                                                                                        <Trigger Property="IsMouseOver" Value="True">
                                                                                            <Setter TargetName="border" Property="Background">
                                                                                                <Setter.Value>
                                                                                                    <SolidColorBrush Color="{StaticResource PrimaryColor}" Opacity="0.7"/>
                                                                                                </Setter.Value>
                                                                                            </Setter>
                                                                                        </Trigger>
                                                                                    </ControlTemplate.Triggers>
                                                                                </ControlTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </ListBox.ItemContainerStyle>
                                                                <ListBox.ItemTemplate>
                                                                    <DataTemplate>
                                                                        <Grid>
                                                                            <Grid.RowDefinitions>
                                                                                <RowDefinition Height="Auto"/>
                                                                                <RowDefinition Height="Auto"/>
                                                                                <RowDefinition Height="Auto"/>
                                                                            </Grid.RowDefinitions>

                                                                            <Grid>
                                                                                <Grid.ColumnDefinitions>
                                                                                    <ColumnDefinition Width="*"/>
                                                                                    <ColumnDefinition Width="Auto"/>
                                                                                </Grid.ColumnDefinitions>
                                                                                <TextBox Text="{Binding Name}" Style="{StaticResource ModernTextBox}"
                                                                                       FontSize="16" FontWeight="Medium" Background="Transparent" 
                                                                                       BorderThickness="0" Foreground="{StaticResource OnSurfaceBrush}"/>
                                                                                <Border Grid.Column="1" Background="{StaticResource AccentBrush}" 
                                                                                      Width="24" Height="24" CornerRadius="12">
                                                                                    <TextBlock Text="{Binding Tasks.Count}" Foreground="White" 
                                                                                             FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" 
                                                                                             VerticalAlignment="Center"/>
                                                                                </Border>
                                                                            </Grid>

                                                                            <TextBlock Grid.Row="1" Text="{Binding TimeSpent}" 
                                                                                     Foreground="{StaticResource OnSurfaceVariantBrush}" 
                                                                                     FontSize="13" Margin="0,8,0,0"/>

                                                                            <ProgressBar Grid.Row="2" Value="{Binding CompletionPercentage}" 
                                                                                       Maximum="100" Height="6" Margin="0,12,0,0" 
                                                                                       Background="{StaticResource SurfaceVariantBrush}"
                                                                                       Foreground="{StaticResource PrimaryGradientBrush}"
                                                                                       Style="{StaticResource MaterialDesignLinearProgressBar}"/>
                                                                        </Grid>
                                                                    </DataTemplate>
                                                                </ListBox.ItemTemplate>
                                                            </ListBox>
                                                        </ScrollViewer>

                                                        <!-- Add Project Button -->
                                                        <Button Grid.Row="2" Content="+ New Project" Style="{StaticResource ModernButton}" 
                                                              Margin="0,16,0,0" Command="{Binding AddProjectCommand}"/>
                                                    </Grid>
                                                </Border>

                                                <!-- Tasks Main Panel -->
                                                <Border Grid.Column="1" Style="{StaticResource GlassCard}" Margin="12,0,0,0">
                                                    <Grid Margin="32">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>

                                                        <!-- Project Header -->
                                                        <Grid Margin="0,0,0,24">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <StackPanel>
                                                                <TextBlock Text="{Binding SelectedProject.Name}" FontSize="28" FontWeight="Bold" 
                                                                         Foreground="{StaticResource OnSurfaceBrush}"/>
                                                                <ProgressBar Value="{Binding SelectedProject.CompletionPercentage}" Maximum="100" 
                                                                           Height="8" Margin="0,12,0,0"
                                                                           Background="{StaticResource SurfaceVariantBrush}"
                                                                           Foreground="{StaticResource PrimaryGradientBrush}"/>
                                                            </StackPanel>
                                                            <Border Grid.Column="1" Background="{StaticResource SuccessBrush}" CornerRadius="16" 
                                                                  Padding="16,8" VerticalAlignment="Top">
                                                                <TextBlock Text="{Binding SelectedProject.CompletionPercentage, StringFormat='{}{0}% Complete'}" 
                                                                         Foreground="White" FontWeight="Medium"/>
                                                            </Border>
                                                        </Grid>

                                                        <!-- Stats Cards -->
                                                        <UniformGrid Grid.Row="1" Columns="4" Margin="0,0,0,32">
                                                            <!-- Today's Time -->
                                                            <Border Background="{StaticResource SurfaceVariantBrush}" CornerRadius="16" 
                                                                  Margin="0,0,8,0" Padding="20,16">
                                                                <StackPanel>
                                                                    <material:PackIcon Kind="TrendingUp" Foreground="{StaticResource SuccessBrush}" 
                                                                                     Width="24" Height="24" Margin="0,0,0,8"/>
                                                                    <TextBlock Text="Today's Focus" Foreground="{StaticResource OnSurfaceVariantBrush}" 
                                                                             FontSize="12" Margin="0,0,0,4"/>
                                                                    <TextBlock Text="{Binding TodayStudyTime}" Foreground="{StaticResource OnSurfaceBrush}" 
                                                                             FontSize="20" FontWeight="Bold"/>
                                                                </StackPanel>
                                                            </Border>

                                                            <!-- Estimated Time -->
                                                            <Border Background="{StaticResource SurfaceVariantBrush}" CornerRadius="16" 
                                                                  Margin="4,0" Padding="20,16">
                                                                <StackPanel>
                                                                    <material:PackIcon Kind="ClockOutline" Foreground="{StaticResource AccentBrush}" 
                                                                                     Width="24" Height="24" Margin="0,0,0,8"/>
                                                                    <TextBlock Text="Estimated" Foreground="{StaticResource OnSurfaceVariantBrush}" 
                                                                             FontSize="12" Margin="0,0,0,4"/>
                                                                    <TextBlock Text="{Binding SelectedProject.EstimatedTime}" 
                                                                             Foreground="{StaticResource OnSurfaceBrush}" FontSize="20" FontWeight="Bold"/>
                                                                </StackPanel>
                                                            </Border>

                                                            <!-- Time Spent -->
                                                            <Border Background="{StaticResource SurfaceVariantBrush}" CornerRadius="16" 
                                                                  Margin="4,0" Padding="20,16">
                                                                <StackPanel>
                                                                    <material:PackIcon Kind="Timer" Foreground="{StaticResource WarningBrush}" 
                                                                                     Width="24" Height="24" Margin="0,0,0,8"/>
                                                                    <TextBlock Text="Time Spent" Foreground="{StaticResource OnSurfaceVariantBrush}" 
                                                                             FontSize="12" Margin="0,0,0,4"/>
                                                                    <TextBlock Text="{Binding SelectedProject.TimeSpent}" 
                                                                             Foreground="{StaticResource OnSurfaceBrush}" FontSize="20" FontWeight="Bold"/>
                                                                </StackPanel>
                                                            </Border>

                                                            <!-- Completed Tasks -->
                                                            <Border Background="{StaticResource SurfaceVariantBrush}" CornerRadius="16" 
                                                                  Margin="8,0,0,0" Padding="20,16">
                                                                <StackPanel>
                                                                    <material:PackIcon Kind="CheckCircle" Foreground="{StaticResource PrimaryBrush}" 
                                                                                     Width="24" Height="24" Margin="0,0,0,8"/>
                                                                    <TextBlock Text="Completed" Foreground="{StaticResource OnSurfaceVariantBrush}" 
                                                                             FontSize="12" Margin="0,0,0,4"/>
                                                                    <TextBlock Text="{Binding SelectedProject.CompletedTasks.Count}" 
                                                                             Foreground="{StaticResource OnSurfaceBrush}" FontSize="20" FontWeight="Bold"/>
                                                                </StackPanel>
                                                            </Border>
                                                        </UniformGrid>

                                                        <!-- Add Task Input -->
                                                        <Border Grid.Row="2" Background="{StaticResource SurfaceVariantBrush}" 
                                                              CornerRadius="16" Padding="24,20" Margin="0,0,0,24">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="*"/>
                                                                    <ColumnDefinition Width="200"/>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                </Grid.ColumnDefinitions>

                                                                <TextBox Text="{Binding NewTaskName}" Style="{StaticResource ModernTextBox}"
                                                                       material:HintAssist.Hint="Add a new task..." FontSize="16"
                                                                       Background="Transparent" BorderThickness="0">
                                                                    <TextBox.InputBindings>
                                                                        <KeyBinding Key="Return" Command="{Binding EnterKeyCommand}" CommandParameter="task"/>
                                                                    </TextBox.InputBindings>
                                                                </TextBox>

                                                                <TextBox Grid.Column="1" Text="{Binding NewTaskExpectedTime}" 
                                                                       Style="{StaticResource ModernTextBox}" Margin="16,0"
                                                                       material:HintAssist.Hint="Expected time" Background="Transparent" 
                                                                       BorderThickness="0">
                                                                    <TextBox.InputBindings>
                                                                        <KeyBinding Key="Return" Command="{Binding EnterKeyCommand}" CommandParameter="task"/>
                                                                    </TextBox.InputBindings>
                                                                </TextBox>

                                                                <Button Grid.Column="2" Content="Add Task" Style="{StaticResource ModernButton}"
                                                                      Command="{Binding AddTaskCommand}" MinWidth="120"/>
                                                            </Grid>
                                                        </Border>

                                                        <!-- Tasks List -->
                                                        <ScrollViewer Grid.Row="3" Style="{StaticResource MaterialDesignScrollViewer}">
                                                            <ItemsControl ItemsSource="{Binding Tasks}">
                                                                <ItemsControl.ItemTemplate>
                                                                    <DataTemplate>
                                                                        <Border Background="{StaticResource SurfaceVariantBrush}" CornerRadius="16" 
                                                                              Margin="0,0,0,16" Padding="24,20">
                                                                            <Grid>
                                                                                <Grid.ColumnDefinitions>
                                                                                    <ColumnDefinition Width="Auto"/>
                                                                                    <ColumnDefinition Width="*"/>
                                                                                    <ColumnDefinition Width="Auto"/>
                                                                                </Grid.ColumnDefinitions>

                                                                                <!-- Play Button with Progress Ring -->
                                                                                <Grid Width="56" Height="56">
                                                                                    <Border Background="{StaticResource PrimaryGradientBrush}" 
                                                                                          Width="56" Height="56" CornerRadius="28" Opacity="0.2"/>
                                                                                    <ProgressBar Style="{StaticResource MaterialDesignCircularProgressBar}"
                                                                                               Value="{Binding Progress}" Maximum="100" Width="56" Height="56"
                                                                                               Foreground="{StaticResource PrimaryBrush}"/>
                                                                                    <Button Style="{StaticResource MaterialDesignFloatingActionButton}"
                                                                                          Background="{StaticResource PrimaryGradientBrush}" Width="40" Height="40"
                                                                                          Command="{Binding DataContext.StartTaskCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                                                          CommandParameter="{Binding}">
                                                                                        <material:PackIcon Kind="Play" Width="20" Height="20" Foreground="White"/>
                                                                                    </Button>
                                                                                </Grid>

                                                                                <!-- Task Details -->
                                                                                <StackPanel Grid.Column="1" Margin="20,0" VerticalAlignment="Center">
                                                                                    <TextBox Text="{Binding Name}" Style="{StaticResource ModernTextBox}"
                                                                                           FontSize="16" FontWeight="Medium" Background="Transparent" 
                                                                                           BorderThickness="0" Foreground="{StaticResource OnSurfaceBrush}"/>
                                                                                    <Grid Margin="0,8,0,0">
                                                                                        <Grid.ColumnDefinitions>
                                                                                            <ColumnDefinition Width="Auto"/>
                                                                                            <ColumnDefinition Width="Auto"/>
                                                                                            <ColumnDefinition Width="*"/>
                                                                                        </Grid.ColumnDefinitions>
                                                                                        <Border Background="{StaticResource AccentBrush}" CornerRadius="8" 
                                                                                              Padding="8,4" Margin="0,0,12,0">
                                                                                            <TextBlock Text="{Binding ExpectedTime}" Foreground="White" 
                                                                                                     FontSize="11" FontWeight="Medium"/>
                                                                                        </Border>
                                                                                        <TextBlock Grid.Column="1" Text="{Binding RemainingTime}" 
                                                                                                 Foreground="{StaticResource OnSurfaceVariantBrush}" FontSize="13"/>
                                                                                    </Grid>
                                                                                </StackPanel>

                                                                                <!-- Actions -->
                                                                                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                                                                                    <CheckBox IsChecked="{Binding IsCompleted}" 
                                                                                            Style="{StaticResource MaterialDesignCheckBox}" Margin="0,0,16,0"/>
                                                                                    <Button Style="{StaticResource MaterialDesignIconForegroundButton}"
                                                                                          Foreground="{StaticResource ErrorBrush}"
                                                                                          Command="{Binding DataContext.DeleteTaskCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                                                          CommandParameter="{Binding}">
                                                                                        <material:PackIcon Kind="Delete" Width="20" Height="20"/>
                                                                                    </Button>
                                                                                </StackPanel>
                                                                            </Grid>
                                                                        </Border>
                                                                    </DataTemplate>
                                                                </ItemsControl.ItemTemplate>
                                                            </ItemsControl>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>
                                            </Grid>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <!-- Analytics View -->
                                <DataTrigger Binding="{Binding ShowCompletedTasks}" Value="True">
                                    <Setter Property="Content">
                                        <Setter.Value>
                                            <Border Style="{StaticResource GlassCard}">
                                                <Grid Margin="32">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="*"/>
                                                    </Grid.RowDefinitions>

                                                    <!-- Analytics Header -->
                                                    <Grid Margin="0,0,0,32">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <StackPanel>
                                                            <TextBlock Text="Performance Analytics" FontSize="28" FontWeight="Bold" 
                                                                     Foreground="{StaticResource OnSurfaceBrush}"/>
                                                            <TextBlock Text="Track your productivity and completed tasks" 
                                                                     Foreground="{StaticResource OnSurfaceVariantBrush}" FontSize="14" Margin="0,4,0,0"/>
                                                        </StackPanel>
                                                    </Grid>

                                                    <!-- Time Filters -->
                                                    <Border Grid.Row="1" Background="{StaticResource SurfaceVariantBrush}" 
                                                          CornerRadius="16" Padding="24,16" Margin="0,0,0,32">
                                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                            <RadioButton Content="Today" IsChecked="{Binding ShowToday}" GroupName="TimeFilter"
                                                                       Style="{StaticResource MaterialDesignChoiceChipSecondaryRadioButton}" Margin="0,0,16,0"/>
                                                            <RadioButton Content="This Week" IsChecked="{Binding ShowThisWeek}" GroupName="TimeFilter"
                                                                       Style="{StaticResource MaterialDesignChoiceChipSecondaryRadioButton}" Margin="0,0,16,0"/>
                                                            <RadioButton Content="Last Week" IsChecked="{Binding ShowLastWeek}" GroupName="TimeFilter"
                                                                       Style="{StaticResource MaterialDesignChoiceChipSecondaryRadioButton}" Margin="0,0,16,0"/>
                                                            <RadioButton Content="All Time" IsChecked="{Binding ShowAllTime}" GroupName="TimeFilter"
                                                                       Style="{StaticResource MaterialDesignChoiceChipSecondaryRadioButton}"/>
                                                        </StackPanel>
                                                    </Border>

                                                    <!-- Stats Overview -->
                                                    <UniformGrid Grid.Row="2" Columns="3" Margin="0,0,0,32">
                                                        <Border Background="{StaticResource SurfaceVariantBrush}" CornerRadius="20" 
                                                              Margin="0,0,12,0" Padding="28,24">
                                                            <StackPanel>
                                                                <Border Background="{StaticResource SuccessBrush}" Width="48" Height="48" 
                                                                      CornerRadius="24" Margin="0,0,0,16">
                                                                    <material:PackIcon Kind="CheckCircle" Width="24" Height="24" 
                                                                                     Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                                <TextBlock Text="Tasks Completed" Foreground="{StaticResource OnSurfaceVariantBrush}" 
                                                                         FontSize="14" Margin="0,0,0,8"/>
                                                                <TextBlock Text="{Binding FilteredCompletedTasksCount}" 
                                                                         Foreground="{StaticResource OnSurfaceBrush}" FontSize="32" FontWeight="Bold"/>
                                                            </StackPanel>
                                                        </Border>

                                                        <Border Background="{StaticResource SurfaceVariantBrush}" CornerRadius="20" 
                                                              Margin="6,0" Padding="28,24">
                                                            <StackPanel>
                                                                <Border Background="{StaticResource AccentBrush}" Width="48" Height="48" 
                                                                      CornerRadius="24" Margin="0,0,0,16">
                                                                    <material:PackIcon Kind="ClockOutline" Width="24" Height="24" 
                                                                                     Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                                <TextBlock Text="Total Time" Foreground="{StaticResource OnSurfaceVariantBrush}" 
                                                                         FontSize="14" Margin="0,0,0,8"/>
                                                                <TextBlock Text="{Binding FilteredTotalTimeSpent}" 
                                                                         Foreground="{StaticResource OnSurfaceBrush}" FontSize="32" FontWeight="Bold"/>
                                                            </StackPanel>
                                                        </Border>

                                                        <Border Background="{StaticResource SurfaceVariantBrush}" CornerRadius="20" 
                                                              Margin="12,0,0,0" Padding="28,24">
                                                            <StackPanel>
                                                                <Border Background="{StaticResource PrimaryBrush}" Width="48" Height="48" 
                                                                      CornerRadius="24" Margin="0,0,0,16">
                                                                    <material:PackIcon Kind="TrendingUp" Width="24" Height="24" 
                                                                                     Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                                <TextBlock Text="Success Rate" Foreground="{StaticResource OnSurfaceVariantBrush}" 
                                                                         FontSize="14" Margin="0,0,0,8"/>
                                                                <TextBlock Text="{Binding FilteredCompletionRate}" 
                                                                         Foreground="{StaticResource OnSurfaceBrush}" FontSize="32" FontWeight="Bold"/>
                                                            </StackPanel>
                                                        </Border>
                                                    </UniformGrid>

                                                    <!-- Completed Tasks List -->
                                                    <ScrollViewer Grid.Row="3" Style="{StaticResource MaterialDesignScrollViewer}">
                                                        <ItemsControl ItemsSource="{Binding FilteredCompletedTasks}">
                                                            <ItemsControl.ItemTemplate>
                                                                <DataTemplate>
                                                                    <Border Background="{StaticResource SurfaceVariantBrush}" CornerRadius="16" 
                                                                          Margin="0,0,0,16" Padding="24,20">
                                                                        <Grid>
                                                                            <Grid.ColumnDefinitions>
                                                                                <ColumnDefinition Width="Auto"/>
                                                                                <ColumnDefinition Width="*"/>
                                                                                <ColumnDefinition Width="Auto"/>
                                                                                <ColumnDefinition Width="Auto"/>
                                                                            </Grid.ColumnDefinitions>

                                                                            <Border Background="{StaticResource SuccessBrush}" Width="40" Height="40" 
                                                                                  CornerRadius="20" VerticalAlignment="Center">
                                                                                <material:PackIcon Kind="Check" Width="20" Height="20" 
                                                                                                 Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                            </Border>

                                                                            <StackPanel Grid.Column="1" Margin="20,0" VerticalAlignment="Center">
                                                                                <TextBlock Text="{Binding Name}" FontSize="16" FontWeight="Medium" 
                                                                                         Foreground="{StaticResource OnSurfaceBrush}"/>
                                                                                <TextBlock Text="{Binding CompletedDate}" 
                                                                                         Foreground="{StaticResource OnSurfaceVariantBrush}" FontSize="13" Margin="0,4,0,0"/>
                                                                            </StackPanel>

                                                                            <Border Grid.Column="2" Background="{StaticResource AccentBrush}" CornerRadius="12" 
                                                                                  Padding="12,6" Margin="0,0,16,0" VerticalAlignment="Center">
                                                                                <TextBlock Text="{Binding ExpectedTime}" Foreground="White" 
                                                                                         FontSize="12" FontWeight="Medium"/>
                                                                            </Border>

                                                                            <Border Grid.Column="3" Background="{StaticResource PrimaryBrush}" CornerRadius="12" 
                                                                                  Padding="12,6" VerticalAlignment="Center">
                                                                                <TextBlock Text="Completed" Foreground="White" 
                                                                                         FontSize="12" FontWeight="Medium"/>
                                                                            </Border>
                                                                        </Grid>
                                                                    </Border>
                                                                </DataTemplate>
                                                            </ItemsControl.ItemTemplate>
                                                        </ItemsControl>
                                                    </ScrollViewer>
                                                </Grid>
                                            </Border>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </material:TransitioningContent.Style>
                </material:TransitioningContent>
            </Grid>

            <!-- Timer Overlay with Modern Design -->
            <Grid Grid.RowSpan="2" Background="#000000" Opacity="0.8" 
                Visibility="{Binding IsTimerRunning, Converter={StaticResource BooleanToVisibilityConverter}}"
                Panel.ZIndex="1000">
                <Border Background="{StaticResource SurfaceBrush}" CornerRadius="32" 
                      HorizontalAlignment="Center" VerticalAlignment="Center" 
                      MinWidth="500" MinHeight="400" Padding="48">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Timer Header -->
                        <TextBlock Text="Focus Session" FontSize="20" FontWeight="Medium" 
                                 Foreground="{StaticResource OnSurfaceBrush}" HorizontalAlignment="Center" Margin="0,0,0,24"/>

                        <!-- Circular Timer -->
                        <Grid Width="280" Height="280" Grid.Row="1">
                            <Border Background="{StaticResource SurfaceVariantBrush}" Width="280" Height="280" 
                                  CornerRadius="140" Opacity="0.3"/>
                            <ProgressBar Value="{Binding TimerProgress}" Maximum="100" 
                                       Style="{StaticResource MaterialDesignCircularProgressBar}"
                                       Width="280" Height="280" Foreground="{StaticResource PrimaryGradientBrush}"
                                       IsIndeterminate="False"/>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock Text="{Binding TimerCountdown}" FontSize="48" FontWeight="Bold" 
                                         Foreground="{StaticResource OnSurfaceBrush}" HorizontalAlignment="Center"/>
                                <TextBlock Text="Remaining" FontSize="14" 
                                         Foreground="{StaticResource OnSurfaceVariantBrush}" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                            </StackPanel>
                        </Grid>

                        <!-- Task Name -->
                        <TextBlock Grid.Row="2" Text="{Binding TimerTaskName}" FontSize="18" FontWeight="Medium" 
                                 Foreground="{StaticResource OnSurfaceBrush}" HorizontalAlignment="Center" 
                                 TextAlignment="Center" TextWrapping="Wrap" Margin="0,32,0,24"/>

                        <!-- Control Buttons -->
                        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button Content="Pause" Style="{StaticResource ModernButton}" Margin="0,0,16,0" 
                                  Background="{StaticResource WarningBrush}" MinWidth="120"/>
                            <Button Content="Stop" Command="{Binding StopTimerCommand}" Style="{StaticResource ModernButton}"
                                  Background="{StaticResource ErrorBrush}" MinWidth="120"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>